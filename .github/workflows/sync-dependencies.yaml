---
name: Update versions.json

# yamllint disable-line rule:truthy
on:
  workflow_dispatch:
  schedule:
    - cron: '0 5 * * 1' # Every Monday at 05:00

jobs:
  update-versions:
    name: Update versions.json from PyPI
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pull-requests: write
    steps:
      - name: â¬‡ï¸ Checkout repository
        uses: actions/checkout@v6.0.1
      - name: ğŸ— Set up UV
        uses: astral-sh/setup-uv@v7.2.0
        with:
          version: "latest"
          enable-cache: true
      - name: ğŸ— Install workflow dependencies
        run: uv sync
      - name: â™»ï¸ Run update_versions.py
        run: uv run python scripts/update_versions.py
      - name: ğŸ‘ Commit & create PR if changed
        uses: peter-evans/create-pull-request@v8.1.0
        with:
          commit-message: "â™»ï¸ Update versions.json"
          title: "â™»ï¸ Update versions.json"
          body: "This PR updates dependencies in versions.json to the latest versions from PyPI."
          branch: chore/update-versions
          delete-branch: true
          labels: dependencies
